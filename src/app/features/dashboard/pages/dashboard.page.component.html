<section class="space-y-8 sm:space-y-12 animate-fade-in">
  <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3">
    <h2 class="text-2xl font-bold text-white">Resumo Financeiro</h2>
    <div class="flex items-center gap-3 w-full sm:w-auto flex-wrap">
      <div *ngIf="!filtroTodoPeriodo()" [formGroup]="filtroForm" class="w-full sm:w-auto">
        <app-input-data [modo]="'mes'" formControlName="mes"></app-input-data>
      </div>
      <div class="flex p-1.5 bg-slate-900/80 rounded-full border border-white/5 flex-wrap">
        <app-botao
          [tamanho]="TamanhoBotaoEnum.Pequeno"
          [tipo]="TipoBotaoEnum.Texto"
          (aoClicar)="filtroTodoPeriodo.set(false)"
          [classeExtra]="
            (!filtroTodoPeriodo() ? 'bg-slate-700 text-white' : 'text-slate-400') + ' rounded-full'
          "
        >
          Por Mês
        </app-botao>
        <app-botao
          [tamanho]="TamanhoBotaoEnum.Pequeno"
          [tipo]="TipoBotaoEnum.Texto"
          (aoClicar)="filtroTodoPeriodo.set(true)"
          [classeExtra]="
            (filtroTodoPeriodo() ? 'bg-purple-600 text-white' : 'text-slate-400') + ' rounded-full'
          "
        >
          Média Geral
        </app-botao>
      </div>
      <app-botao
        [tamanho]="TamanhoBotaoEnum.Pequeno"
        [tipo]="TipoBotaoEnum.Primario"
        (aoClicar)="abrirNovoGasto()"
        >Novo Gasto</app-botao
      >
    </div>
  </div>

  @defer (on viewport) {
    <app-grafico-fluxo-diario-apex
      class="block"
      [transacoes]="transacoesFiltradas()"
      [filtroTodoPeriodo]="filtroTodoPeriodo()"
      [anoMes]="filtroMes()"
    ></app-grafico-fluxo-diario-apex>
  } @placeholder {
    <div
      class="bg-slate-900/80 border border-white/5 p-6 rounded-3xl min-h-[320px] sm:min-h-[360px] animate-pulse"
    ></div>
  }

  @defer (on viewport) {
    <app-top-categorias-apex
      class="block"
      [transacoes]="transacoesFiltradas()"
      [topN]="5"
    ></app-top-categorias-apex>
  } @placeholder {
    <div
      class="bg-slate-900/80 border border-white/5 p-6 rounded-3xl min-h-[320px] sm:min-h-[360px] animate-pulse"
    ></div>
  }

  @defer (on viewport) {
    <app-grafico-donut-apex
      class="block"
      [transacoes]="transacoesFiltradas()"
      [topN]="8"
    ></app-grafico-donut-apex>
  } @placeholder {
    <div
      class="bg-slate-900/80 border border-white/5 p-6 rounded-3xl min-h-[320px] sm:min-h-[360px] animate-pulse"
    ></div>
  }

  @defer (on viewport) {
    <app-grafico-saldo-acumulado-apex
      class="block"
      [transacoes]="transacoesFiltradas()"
    ></app-grafico-saldo-acumulado-apex>
  } @placeholder {
    <div
      class="bg-slate-900/80 border border-white/5 p-6 rounded-3xl min-h-[320px] sm:min-h-[360px] animate-pulse"
    ></div>
  }

  <app-objetivo-economia-card
    class="block"
    [metaEconomiaPorcentagem]="config.config().metaEconomiaPorcentagem"
    [valorParaGuardar]="valorParaGuardar()"
    [dinheiroGuardadoAtual]="config.config().dinheiroGuardadoAtual"
    [objetivoFinanceiro]="config.config().objetivoFinanceiro"
    [porcentagemConquista]="porcentagemConquista()"
  ></app-objetivo-economia-card>

  <app-novo-gasto-modal
    [open]="novoGastoAberto()"
    [categorias]="categoriasDisponiveis()"
    (closed)="fecharNovoGasto()"
    (saved)="onSubmitNovoGasto($event)"
  ></app-novo-gasto-modal>
</section>
