"use strict";(self.webpackChunkcsharp_cash=self.webpackChunkcsharp_cash||[]).push([[272],{8272:(H,p,r)=>{r.r(p),r.d(p,{DashboardPageComponent:()=>U});var o=r(4438),c=r(177),i=r(4341),v=r(9039),b=r(4016),C=r(6927),G=r(4885),P=r(2839),x=r(1605),h=r(741),f=r(6848),g=r(9385),d=r(3993);const F=()=>({categoriaNaoExistente:"Categoria nova \u2014 ser\xe1 criada ao salvar"});function N(e,l){if(1&e){const a=o.RV6();o.j41(0,"div",1)(1,"div",2),o.bIt("click",function(){o.eBV(a);const t=o.XpG();return o.Njj(t.fechar())})("keyup.enter",function(){o.eBV(a);const t=o.XpG();return o.Njj(t.fechar())}),o.k0s(),o.j41(2,"div",3)(3,"h3",4),o.EFF(4,"Novo Gasto"),o.k0s(),o.j41(5,"div",5)(6,"app-campo-formulario",6),o.nrm(7,"input",7),o.k0s(),o.j41(8,"app-campo-formulario",8),o.nrm(9,"app-input-moeda",9),o.k0s(),o.j41(10,"div",5)(11,"app-campo-formulario",10),o.nrm(12,"app-input-data",11),o.k0s(),o.j41(13,"app-campo-formulario",12),o.nrm(14,"app-categoria-select",13),o.k0s()(),o.j41(15,"app-campo-formulario",14),o.nrm(16,"app-pagamento-select",15),o.k0s()(),o.j41(17,"div",16)(18,"app-botao",17),o.bIt("aoClicar",function(){o.eBV(a);const t=o.XpG();return o.Njj(t.fechar())}),o.EFF(19,"Cancelar"),o.k0s(),o.j41(20,"app-botao",17),o.bIt("aoClicar",function(){o.eBV(a);const t=o.XpG();return o.Njj(t.salvar())}),o.EFF(21,"Salvar"),o.k0s()()()()}if(2&e){let a,n;const t=o.XpG();o.R7$(2),o.Y8G("formGroup",t.form),o.R7$(4),o.Y8G("nomeControle","descricao")("idInput",t.idDescricao)("obrigatorio",!0),o.R7$(),o.Y8G("id",t.idDescricao),o.R7$(),o.Y8G("nomeControle","valor")("idInput",t.idValor)("obrigatorio",!0),o.R7$(),o.Y8G("id",t.idValor),o.R7$(2),o.Y8G("nomeControle","data")("idInput",t.idData)("obrigatorio",!0),o.R7$(),o.Y8G("id",t.idData),o.R7$(),o.Y8G("nomeControle","categoria")("obrigatorio",!0)("mensagensErro",o.lJ4(27,F)),o.R7$(),o.Y8G("obrigatorio",!0)("tocado",null!==(a=null==(a=t.form.get("categoria"))?null:a.touched)&&void 0!==a&&a),o.R7$(),o.Y8G("nomeControle","metodoPagamento")("obrigatorio",!0),o.R7$(),o.Y8G("cartoes",t.cartoes)("obrigatorio",!0)("tocado",null!==(n=null==(n=t.form.get("metodoPagamento"))?null:n.touched)&&void 0!==n&&n),o.R7$(2),o.Y8G("tamanho",t.TamanhoBotaoEnum.Pequeno)("tipo",t.TipoBotaoEnum.Secundario),o.R7$(2),o.Y8G("tamanho",t.TamanhoBotaoEnum.Pequeno)("tipo",t.TipoBotaoEnum.Primario)}}let j=(()=>{class e{constructor(){this.fb=(0,o.WQX)(i.ok),this.carteira=(0,o.WQX)(g.t),this.open=!1,this.categorias=[],this.initialValues=null,this.closed=new o.bkB,this.saved=new o.bkB,this.valorExibicao="",this.idDescricao="desc-"+Math.random().toString(36).slice(2,9),this.idValor="val-"+Math.random().toString(36).slice(2,9),this.idData="date-"+Math.random().toString(36).slice(2,9),this.TipoBotaoEnum=d.JM,this.TamanhoBotaoEnum=d.nT,this.form=function E(e){return e.group({descricao:["",[i.k0.required,i.k0.minLength(2)]],valor:[null,[i.k0.required,i.k0.min(.01)]],data:[(new Date).toISOString().slice(0,10),[i.k0.required]],categoria:["Geral",[i.k0.required]],metodoPagamento:["DINHEIRO",[i.k0.required]]})}(this.fb)}get cartoes(){return this.carteira.cartoes()}ngOnChanges(a){if(a.initialValues&&this.initialValues){this.form.patchValue({descricao:this.initialValues.descricao??"",valor:this.initialValues.valor??null,data:this.initialValues.data??(new Date).toISOString().slice(0,10),categoria:this.initialValues.categoria??"Geral",metodoPagamento:this.initialValues.metodoPagamento??"DINHEIRO"});const t=this.initialValues.valor??null;this.valorExibicao=null!=t?this.formatValorNumber(t):""}else{const t=this.form.get("valor").value;this.valorExibicao=null!=t?this.formatValorNumber(t):""}const n=this.form.get("categoria");n&&(n.setAsyncValidators(function D(e){const l=e.map(n=>n.toLowerCase()),a=new Set([...l,"geral","outros"]);return n=>new Promise(t=>{const s=(n.value??"").toString().trim();setTimeout(()=>{if(!s)return t(null);const m=a.has(s.toLowerCase());t(m?null:{categoriaNaoExistente:!0})},300)})}(this.categorias)),n.updateValueAndValidity({emitEvent:!1}))}fechar(){this.closed.emit()}salvar(){if(this.form.invalid)return void this.form.markAllAsTouched();const{descricao:a,valor:n,data:t,categoria:s,metodoPagamento:m}=this.form.getRawValue();this.saved.emit({descricao:(a??"").trim(),valor:Number(n??0),data:t??(new Date).toISOString().slice(0,10),categoria:(s??"Geral").trim(),metodoPagamento:m??"DINHEIRO"}),this.resetar()}resetar(){this.form.reset({descricao:"",valor:null,data:(new Date).toISOString().slice(0,10),categoria:"Geral",metodoPagamento:"DINHEIRO"}),this.valorExibicao=""}onValorInput(a){const t=a.target.value;this.valorExibicao=t;const s=this.parsePtBrNumber(t);this.form.get("valor").setValue(s)}formatValor(){const a=this.form.get("valor").value;this.valorExibicao=null!=a?this.formatValorNumber(a):""}parsePtBrNumber(a){const n=a.replace(/[^\d,.-]/g,"").replace(/\./g,"").replace(",","."),t=Number(n);return Number.isFinite(t)?t:null}formatValorNumber(a){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a)}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=o.VBU({type:e,selectors:[["app-novo-gasto-modal"]],inputs:{open:"open",categorias:"categorias",initialValues:"initialValues"},outputs:{closed:"closed",saved:"saved"},standalone:!0,features:[o.OA$,o.aNF],decls:1,vars:1,consts:[["class","fixed inset-0 z-50 flex items-center justify-center",4,"ngIf"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center"],["role","button","tabindex","0",1,"absolute","inset-0","bg-black/60",3,"click","keyup.enter"],[1,"relative","bg-slate-900","border","border-white/10","rounded-3xl","p-6","w-full","max-w-md","shadow-2xl",3,"formGroup"],[1,"text-lg","font-bold","mb-4","text-white"],[1,"space-y-3"],["rotulo","Descri\xe7\xe3o",3,"nomeControle","idInput","obrigatorio"],["type","text","formControlName","descricao",1,"w-full","bg-slate-800","border","border-slate-700","rounded-2xl","px-4","py-2","text-sm","text-white","outline-none",3,"id"],["rotulo","Valor",3,"nomeControle","idInput","obrigatorio"],["formControlName","valor",3,"id"],["rotulo","Data",3,"nomeControle","idInput","obrigatorio"],["formControlName","data",3,"id"],["rotulo","Categoria",3,"nomeControle","obrigatorio","mensagensErro"],["formControlName","categoria",3,"obrigatorio","tocado"],["rotulo","Pagamento",3,"nomeControle","obrigatorio"],["formControlName","metodoPagamento",3,"cartoes","obrigatorio","tocado"],[1,"flex","justify-end","gap-2","mt-5"],[3,"aoClicar","tamanho","tipo"]],template:function(n,t){1&n&&o.DNE(0,N,22,28,"div",0),2&n&&o.Y8G("ngIf",t.open)},dependencies:[c.MD,c.bT,i.X1,i.me,i.BC,i.cb,i.j4,i.JD,C.J,G.E,P.E,x.k,h.a,f.n],encapsulation:2})}}return e})();var T=r(2154),R=r(1593),I=r(7419),y=r(4667),u=r(4550);let B=(()=>{class e{constructor(){this.metaEconomiaPorcentagem=0,this.valorParaGuardar=0,this.dinheiroGuardadoAtual=0,this.objetivoFinanceiro=0,this.porcentagemConquista=0}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=o.VBU({type:e,selectors:[["app-objetivo-economia-card"]],inputs:{metaEconomiaPorcentagem:"metaEconomiaPorcentagem",valorParaGuardar:"valorParaGuardar",dinheiroGuardadoAtual:"dinheiroGuardadoAtual",objetivoFinanceiro:"objetivoFinanceiro",porcentagemConquista:"porcentagemConquista"},standalone:!0,features:[o.aNF],decls:31,vars:23,consts:[[1,"bg-gradient-to-br","from-slate-900","to-slate-800","border","border-white/5","p-6","rounded-3xl","min-h-[320px]","sm:min-h-[360px]"],[1,"text-lg","font-bold","mb-4","text-white"],[1,"flex","justify-between","text-sm","mb-1","text-slate-400"],[1,"text-white","font-mono"],[1,"mt-6","pt-6","border-t","border-white/5"],[1,"flex","justify-between","items-end","mb-2"],[1,"text-sm","text-slate-400"],[1,"text-2xl","font-bold","text-pink-400"],[1,"flex","justify-between","items-end"],[1,"text-xs","text-slate-500"],[1,"text-xs","text-pink-400","font-bold"],[1,"w-full","bg-slate-950","h-3","mt-2","rounded-full","overflow-hidden","border","border-white/5"],[1,"h-full","bg-gradient-to-r","from-pink-600","to-purple-600","shadow-[0_0_15px_rgba(236,72,153,0.5)]","transition-all","duration-1000"],[1,"text-xs","text-center","mt-3","text-slate-400"],[1,"text-white"]],template:function(n,t){1&n&&(o.j41(0,"div",0)(1,"h3",1),o.EFF(2,"Objetivo de Economia"),o.k0s(),o.j41(3,"div",2)(4,"span"),o.EFF(5),o.k0s(),o.j41(6,"span",3),o.EFF(7),o.nI1(8,"currency"),o.k0s()(),o.j41(9,"div",4)(10,"div",5)(11,"span",6),o.EFF(12,"Total Guardado"),o.k0s(),o.j41(13,"span",7),o.EFF(14),o.nI1(15,"currency"),o.k0s()(),o.j41(16,"div",8)(17,"span",9),o.EFF(18),o.nI1(19,"currency"),o.k0s(),o.j41(20,"span",10),o.EFF(21),o.nI1(22,"number"),o.k0s()(),o.j41(23,"div",11),o.nrm(24,"div",12),o.k0s(),o.j41(25,"p",13),o.EFF(26," Falta "),o.j41(27,"span",14),o.EFF(28),o.nI1(29,"currency"),o.k0s(),o.EFF(30," para seu sonho! "),o.k0s()()()),2&n&&(o.R7$(5),o.SpI("Meta Mensal (",t.metaEconomiaPorcentagem,"%)"),o.R7$(2),o.JRh(o.i5U(8,8,t.valorParaGuardar,"BRL")),o.R7$(7),o.SpI(" ",o.i5U(15,11,t.dinheiroGuardadoAtual,"BRL")," "),o.R7$(4),o.SpI(" Objetivo: ",o.i5U(19,14,t.objetivoFinanceiro,"BRL")," "),o.R7$(3),o.SpI(" ",o.i5U(22,17,t.porcentagemConquista,"1.0-1"),"% "),o.R7$(3),o.xc7("width",t.porcentagemConquista>100?100:t.porcentagemConquista,"%"),o.R7$(4),o.SpI(" ",o.i5U(29,20,t.objetivoFinanceiro-t.dinheiroGuardadoAtual,"BRL")," "))},dependencies:[c.MD,c.QX,c.oe],encapsulation:2,changeDetection:0})}}return e})();const V=()=>[Promise.all([r.e(660),r.e(254)]).then(r.bind(r,1254)).then(e=>e.GraficoFluxoDiarioApexComponent)],A=()=>[Promise.all([r.e(660),r.e(686)]).then(r.bind(r,4686)).then(e=>e.TopCategoriasApexComponent)],M=()=>[Promise.all([r.e(660),r.e(190)]).then(r.bind(r,4190)).then(e=>e.GraficoDonutApexComponent)],$=()=>[Promise.all([r.e(660),r.e(348)]).then(r.bind(r,1348)).then(e=>e.GraficoSaldoAcumuladoApexComponent)];function Y(e,l){if(1&e&&(o.j41(0,"div",10),o.nrm(1,"app-input-data",11),o.k0s()),2&e){const a=o.XpG();o.Y8G("formGroup",a.filtroForm),o.R7$(),o.Y8G("modo","mes")}}function w(e,l){if(1&e&&o.nrm(0,"app-grafico-fluxo-diario-apex",12),2&e){const a=o.XpG();o.Y8G("transacoes",a.transacoesFiltradas())("filtroTodoPeriodo",a.filtroTodoPeriodo())("anoMes",a.filtroMes())}}function S(e,l){1&e&&o.nrm(0,"div",13)}function k(e,l){if(1&e&&o.nrm(0,"app-top-categorias-apex",14),2&e){const a=o.XpG();o.Y8G("transacoes",a.transacoesFiltradas())("topN",5)}}function W(e,l){1&e&&o.nrm(0,"div",13)}function X(e,l){if(1&e&&o.nrm(0,"app-grafico-donut-apex",14),2&e){const a=o.XpG();o.Y8G("transacoes",a.transacoesFiltradas())("topN",8)}}function O(e,l){1&e&&o.nrm(0,"div",13)}function L(e,l){if(1&e&&o.nrm(0,"app-grafico-saldo-acumulado-apex",15),2&e){const a=o.XpG();o.Y8G("transacoes",a.transacoesFiltradas())}}function Q(e,l){1&e&&o.nrm(0,"div",13)}let U=(()=>{class e{constructor(){this.config=(0,o.WQX)(T.w),this.fixos=(0,o.WQX)(R.N),this.transacoes=(0,o.WQX)(I.j),this.carteira=(0,o.WQX)(g.t),this.toast=(0,o.WQX)(b.W),this.filtroTodoPeriodo=(0,o.vPA)(!1),this.filtroMes=(0,o.vPA)((0,u.R)()),this.fb=(0,o.WQX)(i.ok),this.filtroForm=this.fb.group({mes:[(0,u.R)()]}),this.novoGastoAberto=(0,o.vPA)(!1),this.TipoBotaoEnum=d.JM,this.TamanhoBotaoEnum=d.nT,this.mesFormatado=(0,o.EWP)(()=>{const[a,n]=this.filtroMes().split("-");return new Date(Number(a),Number(n)-1,1).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}),this.tituloFluxoDiario=(0,o.EWP)(()=>this.filtroTodoPeriodo()?"Evolu\xe7\xe3o Mensal (Total Gasto)":`Fluxo Di\xe1rio (${this.mesFormatado()})`),this.totalFixos=(0,o.EWP)(()=>this.fixos.totalNoMes(this.filtroMes())),this.porcentagemRendaComprometida=(0,o.EWP)(()=>{const a=this.config.config().rendaMensal||1;return this.totalFixos()/a*100}),this.transacoesFiltradas=(0,o.EWP)(()=>{const a=this.transacoes.transacoes();if(this.filtroTodoPeriodo())return a;const n=this.filtroMes();return a.filter(t=>t.data.startsWith(n))}),this.totalGastosDisplay=(0,o.EWP)(()=>this.transacoesFiltradas().reduce((a,n)=>a+n.valor,0)),this.porcentagemGastoRenda=(0,o.EWP)(()=>{const a=this.config.config().rendaMensal||1;return Math.min(100,this.totalGastosDisplay()/a*100)}),this.valorParaGuardar=(0,o.EWP)(()=>{const a=this.config.config();return a.rendaMensal*a.metaEconomiaPorcentagem/100}),this.porcentagemConquista=(0,o.EWP)(()=>{const a=this.config.config();return Math.min(100,a.dinheiroGuardadoAtual/(a.objetivoFinanceiro||1)*100)}),this.categoriasDisponiveis=(0,o.EWP)(()=>{const a=new Set;for(const n of this.transacoes.transacoes())a.add(n.categoria);for(const n of this.fixos.fixos())a.add(n.categoria);return Array.from(a.values())}),this.getIconeCategoria=y.w,this.estadoVazio=(0,o.EWP)(()=>0===this.transacoes.transacoes().length&&0===this.fixos.fixos().length&&0===this.carteira.cartoes().length),this.filtroForm.get("mes").valueChanges.subscribe(a=>this.filtroMes.set(a??(0,u.R)()))}abrirNovoGasto(){this.novoGastoAberto.set(!0)}fecharNovoGasto(){this.novoGastoAberto.set(!1)}onSubmitNovoGasto(a){this.transacoes.adicionar(a),this.toast.sucesso("Gasto adicionado"),this.novoGastoAberto.set(!1)}handleAtalho(a){a.shiftKey&&"n"===a.key.toLowerCase()&&(a.preventDefault(),this.novoGastoAberto()||this.abrirNovoGasto())}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=o.VBU({type:e,selectors:[["app-dashboard-page"]],hostBindings:function(n,t){1&n&&o.bIt("keydown",function(m){return t.handleAtalho(m)},!1,o.EBC)},standalone:!0,features:[o.aNF],decls:31,vars:16,consts:[[1,"space-y-8","sm:space-y-12","animate-fade-in"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","gap-3"],[1,"text-2xl","font-bold","text-white"],[1,"flex","items-center","gap-3","w-full","sm:w-auto","flex-wrap"],["class","w-full sm:w-auto",3,"formGroup",4,"ngIf"],[1,"flex","p-1.5","bg-slate-900/80","rounded-full","border","border-white/5","flex-wrap"],[3,"aoClicar","tamanho","tipo","classeExtra"],[3,"aoClicar","tamanho","tipo"],[1,"block",3,"metaEconomiaPorcentagem","valorParaGuardar","dinheiroGuardadoAtual","objetivoFinanceiro","porcentagemConquista"],[3,"closed","saved","open","categorias"],[1,"w-full","sm:w-auto",3,"formGroup"],["formControlName","mes",3,"modo"],[1,"block",3,"transacoes","filtroTodoPeriodo","anoMes"],[1,"bg-slate-900/80","border","border-white/5","p-6","rounded-3xl","min-h-[320px]","sm:min-h-[360px]","animate-pulse"],[1,"block",3,"transacoes","topN"],[1,"block",3,"transacoes"]],template:function(n,t){1&n&&(o.j41(0,"section",0)(1,"div",1)(2,"h2",2),o.EFF(3,"Resumo Financeiro"),o.k0s(),o.j41(4,"div",3),o.DNE(5,Y,2,2,"div",4),o.j41(6,"div",5)(7,"app-botao",6),o.bIt("aoClicar",function(){return t.filtroTodoPeriodo.set(!1)}),o.EFF(8," Por M\xeas "),o.k0s(),o.j41(9,"app-botao",6),o.bIt("aoClicar",function(){return t.filtroTodoPeriodo.set(!0)}),o.EFF(10," M\xe9dia Geral "),o.k0s()(),o.j41(11,"app-botao",7),o.bIt("aoClicar",function(){return t.abrirNovoGasto()}),o.EFF(12,"Novo Gasto"),o.k0s()()(),o.DNE(13,w,1,3)(14,S,1,0),o.nv$(15,13,V,null,14),o.qhs(0,-1),o.DNE(17,k,1,2)(18,W,1,0),o.nv$(19,17,A,null,18),o.qhs(0,-1),o.DNE(21,X,1,2)(22,O,1,0),o.nv$(23,21,M,null,22),o.qhs(0,-1),o.DNE(25,L,1,1)(26,Q,1,0),o.nv$(27,25,$,null,26),o.qhs(0,-1),o.nrm(29,"app-objetivo-economia-card",8),o.j41(30,"app-novo-gasto-modal",9),o.bIt("closed",function(){return t.fecharNovoGasto()})("saved",function(m){return t.onSubmitNovoGasto(m)}),o.k0s()()),2&n&&(o.R7$(5),o.Y8G("ngIf",!t.filtroTodoPeriodo()),o.R7$(2),o.Y8G("tamanho",t.TamanhoBotaoEnum.Pequeno)("tipo",t.TipoBotaoEnum.Texto)("classeExtra",(t.filtroTodoPeriodo()?"text-slate-400":"bg-slate-700 text-white")+" rounded-full"),o.R7$(2),o.Y8G("tamanho",t.TamanhoBotaoEnum.Pequeno)("tipo",t.TipoBotaoEnum.Texto)("classeExtra",(t.filtroTodoPeriodo()?"bg-purple-600 text-white":"text-slate-400")+" rounded-full"),o.R7$(2),o.Y8G("tamanho",t.TamanhoBotaoEnum.Pequeno)("tipo",t.TipoBotaoEnum.Primario),o.R7$(18),o.Y8G("metaEconomiaPorcentagem",t.config.config().metaEconomiaPorcentagem)("valorParaGuardar",t.valorParaGuardar())("dinheiroGuardadoAtual",t.config.config().dinheiroGuardadoAtual)("objetivoFinanceiro",t.config.config().objetivoFinanceiro)("porcentagemConquista",t.porcentagemConquista()),o.R7$(),o.Y8G("open",t.novoGastoAberto())("categorias",t.categoriasDisponiveis()))},dependencies:[c.MD,c.bT,i.X1,i.BC,i.cb,i.j4,i.JD,v.iI,j,h.a,f.n,B],encapsulation:2,changeDetection:0})}}return e})()}}]);