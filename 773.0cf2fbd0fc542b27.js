"use strict";(self.webpackChunkcsharp_cash=self.webpackChunkcsharp_cash||[]).push([[773],{1773:(G,p,r)=>{r.r(p),r.d(p,{TransacoesPageComponent:()=>y});var o=r(4438),m=r(177),s=r(4341),g=r(7419),f=r(9385),h=r(4667),c=r(4550),x=r(2839),b=r(1605),v=r(6927),E=r(4885),F=r(741),T=r(6848),u=r(3993);const R=()=>({categoriaNaoExistente:"Categoria nova \u2014 ser\xe1 criada ao salvar"});function j(n,d){if(1&n){const t=o.RV6();o.j41(0,"app-botao",25),o.bIt("aoClicar",function(){o.eBV(t);const e=o.XpG();return o.Njj(e.cancelarEdicaoTransacao())}),o.EFF(1,"Cancelar"),o.k0s()}if(2&n){const t=o.XpG();o.Y8G("tipo",t.TipoBotaoEnum.Texto)("tamanho",t.TamanhoBotaoEnum.Medio)("classeExtra","text-slate-400 hover:text-yellow-500")}}function I(n,d){1&n&&(o.j41(0,"span",36),o.EFF(1,"FIXO"),o.k0s())}function P(n,d){if(1&n){const t=o.RV6();o.j41(0,"div",26)(1,"div",27)(2,"div",28),o.EFF(3),o.k0s(),o.j41(4,"div")(5,"p",29),o.EFF(6),o.k0s(),o.j41(7,"p",30)(8,"span"),o.EFF(9),o.nI1(10,"date"),o.k0s(),o.EFF(11," \u2022 "),o.j41(12,"span",31),o.EFF(13),o.k0s(),o.DNE(14,I,2,0,"span",32),o.k0s()()(),o.j41(15,"div",33)(16,"p",34),o.EFF(17),o.nI1(18,"currency"),o.k0s(),o.j41(19,"div",35)(20,"app-botao",25),o.bIt("aoClicar",function(){const e=o.eBV(t).$implicit,l=o.XpG();return o.Njj(l.iniciarEdicaoTransacao(e))}),o.EFF(21,"Editar"),o.k0s(),o.j41(22,"app-botao",25),o.bIt("aoClicar",function(){const e=o.eBV(t).$implicit,l=o.XpG();return o.Njj(l.removerTransacao(e.id))}),o.EFF(23,"Excluir"),o.k0s()()()()}if(2&n){const t=d.$implicit,a=o.XpG();o.R7$(3),o.SpI(" ",a.getIconeCategoria(t.categoria)," "),o.R7$(3),o.JRh(t.descricao),o.R7$(3),o.JRh(o.i5U(10,12,t.data,"dd/MM/yyyy")),o.R7$(4),o.JRh(a.getNomeMetodo(t.metodoPagamento)),o.R7$(),o.Y8G("ngIf",t.origemFixoId),o.R7$(3),o.SpI("- ",o.i5U(18,15,t.valor,"BRL"),""),o.R7$(3),o.Y8G("tipo",a.TipoBotaoEnum.Texto)("tamanho",a.TamanhoBotaoEnum.Pequeno)("classeExtra","text-slate-400 hover:text-yellow-500"),o.R7$(2),o.Y8G("tipo",a.TipoBotaoEnum.Texto)("tamanho",a.TamanhoBotaoEnum.Pequeno)("classeExtra","text-slate-400 hover:text-red-500")}}function k(n,d){1&n&&(o.j41(0,"div",37),o.EFF(1," Nenhuma transa\xe7\xe3o encontrada. "),o.k0s())}let y=(()=>{class n{constructor(){this.transacoes=(0,o.WQX)(g.j),this.carteira=(0,o.WQX)(f.t),this.fb=(0,o.WQX)(s.ok),this.filtroTodoPeriodo=(0,o.vPA)(!1),this.filtroMes=(0,o.vPA)((0,c.R)()),this.filtroForm=this.fb.group({mes:[(0,c.R)()]}),this.transacaoForm=function C(n){return n.group({descricao:["",[s.k0.required,s.k0.minLength(2)]],valor:[null,[s.k0.required,s.k0.min(.01)]],data:[(0,c.t)(),[s.k0.required]],categoria:["Outros",[s.k0.required]],metodoPagamento:["DINHEIRO",[s.k0.required]]})}(this.fb),this.TipoBotaoEnum=u.JM,this.TamanhoBotaoEnum=u.nT,this.editandoId=(0,o.vPA)(null),this.transacoesFiltradas=(0,o.EWP)(()=>{const t=this.transacoes.transacoes();if(this.filtroTodoPeriodo())return t;const a=this.filtroMes();return t.filter(e=>e.data.startsWith(a))}),this.getIconeCategoria=h.w,this.filtroForm.get("mes").valueChanges.subscribe(t=>this.filtroMes.set(t??(0,c.R)()))}adicionarTransacao(t){if(t.preventDefault(),this.transacaoForm.invalid)return void this.transacaoForm.markAllAsTouched();const a=this.transacaoForm.getRawValue(),e=this.editandoId();e?(this.transacoes.atualizar(e,{descricao:(a.descricao??"").trim(),valor:Number(a.valor??0),data:a.data??(0,c.t)(),categoria:(a.categoria??"Outros").trim(),metodoPagamento:a.metodoPagamento??"DINHEIRO"}),this.editandoId.set(null)):this.transacoes.adicionar({descricao:(a.descricao??"").trim(),valor:Number(a.valor??0),data:a.data??(0,c.t)(),categoria:(a.categoria??"Outros").trim(),metodoPagamento:a.metodoPagamento??"DINHEIRO"}),this.transacaoForm.reset({descricao:"",valor:null,data:(0,c.t)(),categoria:"Outros",metodoPagamento:"DINHEIRO"})}removerTransacao(t){this.transacoes.remover(t)}cartoes(){return this.carteira.cartoes()}getNomeMetodo(t){return this.carteira.getNomeMetodo(t)}iniciarEdicaoTransacao(t){this.editandoId.set(t.id),this.transacaoForm.patchValue({descricao:t.descricao,valor:t.valor,data:t.data,categoria:t.categoria,metodoPagamento:t.metodoPagamento})}cancelarEdicaoTransacao(){this.editandoId.set(null),this.transacaoForm.reset({descricao:"",valor:null,data:(0,c.t)(),categoria:"Outros",metodoPagamento:"DINHEIRO"})}exportarCSV(){const t=["id,descricao,valor,data,tipo,categoria,metodoPagamento,origemFixoId",...this.transacoesFiltradas().map(i=>[i.id,JSON.stringify(i.descricao),i.valor.toFixed(2),i.data,i.tipo,JSON.stringify(i.categoria),JSON.stringify(i.metodoPagamento),i.origemFixoId??""].join(","))],a=new Blob([t.join("\n")],{type:"text/csv;charset=utf-8;"}),e=URL.createObjectURL(a),l=document.createElement("a");l.href=e,l.download=`transacoes-${this.filtroTodoPeriodo()?"historico":this.filtroMes()}.csv`,l.click(),URL.revokeObjectURL(e)}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275cmp=o.VBU({type:n,selectors:[["app-transacoes-page"]],standalone:!0,features:[o.aNF],decls:31,vars:29,consts:[[1,"animate-fade-in","space-y-6"],[1,"bg-slate-900","border","border-white/10","p-6","rounded-3xl","shadow-xl"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","mb-4","gap-3"],[1,"text-xl","font-bold","text-transparent","bg-clip-text","bg-gradient-to-r","from-purple-400","to-pink-400"],["type","button",1,"px-4","py-2","text-xs","font-bold","bg-slate-800","hover:bg-slate-700","text-white","rounded-full","transition","shadow-lg","border","border-white/10",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4",3,"ngSubmit","formGroup"],["rotulo","Descri\xe7\xe3o",3,"nomeControle","obrigatorio"],["type","text","formControlName","descricao","placeholder","Ex: Mercado Semanal",1,"w-full","bg-slate-950","border","border-slate-800","rounded-2xl","px-4","py-3","text-white","focus:border-pink-500","focus:ring-1","focus:ring-pink-500","outline-none","transition","shadow-inner"],["rotulo","Valor (R$)",3,"nomeControle","obrigatorio"],["formControlName","valor"],["rotulo","Data",3,"nomeControle","obrigatorio"],["formControlName","data"],["rotulo","Categoria",3,"nomeControle","obrigatorio","mensagensErro"],["formControlName","categoria",3,"obrigatorio","tocado"],["rotulo","Pagamento",3,"nomeControle","obrigatorio"],["formControlName","metodoPagamento",3,"cartoes","obrigatorio","tocado"],[1,"md:col-span-2","mt-2","flex","items-center","gap-2"],["tipoHtml","submit",3,"tipo","tamanho","cheio"],[3,"tipo","tamanho","classeExtra","aoClicar",4,"ngIf"],[1,"text-lg","font-bold","text-white","mb-3","px-2","flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","gap-3"],[1,"w-full","sm:w-auto",3,"formGroup"],["formControlName","mes",3,"modo","acoesRapidas"],[1,"space-y-3"],["class","bg-slate-900/50 border border-white/5 p-4 rounded-3xl flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 hover:bg-slate-800/50 transition",4,"ngFor","ngForOf"],["class","text-center py-10 text-slate-600",4,"ngIf"],[3,"aoClicar","tipo","tamanho","classeExtra"],[1,"bg-slate-900/50","border","border-white/5","p-4","rounded-3xl","flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-3","hover:bg-slate-800/50","transition"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-full","bg-slate-800","flex","items-center","justify-center","text-xl","shadow-inner"],[1,"font-medium","text-white"],[1,"text-xs","text-slate-500","flex","flex-wrap","items-center","gap-1"],[1,"px-2","py-0.5","rounded-full","bg-slate-800","text-slate-300","text-[10px]","uppercase","font-bold","tracking-wide"],["class","px-2 py-0.5 rounded-full bg-purple-900/50 text-purple-300 text-[9px] border border-purple-500/30",4,"ngIf"],[1,"text-right","w-full","sm:w-auto"],[1,"font-bold","text-red-400"],[1,"flex","items-center","justify-end","gap-2","mt-2"],[1,"px-2","py-0.5","rounded-full","bg-purple-900/50","text-purple-300","text-[9px]","border","border-purple-500/30"],[1,"text-center","py-10","text-slate-600"]],template:function(a,e){if(1&a&&(o.j41(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),o.EFF(4," Nova Movimenta\xe7\xe3o "),o.k0s(),o.j41(5,"button",4),o.bIt("click",function(){return e.exportarCSV()}),o.EFF(6," Exportar CSV "),o.k0s()(),o.j41(7,"form",5),o.bIt("ngSubmit",function(i){return e.adicionarTransacao(i)}),o.j41(8,"app-campo-formulario",6),o.nrm(9,"input",7),o.k0s(),o.j41(10,"app-campo-formulario",8),o.nrm(11,"app-input-moeda",9),o.k0s(),o.j41(12,"app-campo-formulario",10),o.nrm(13,"app-input-data",11),o.k0s(),o.j41(14,"app-campo-formulario",12),o.nrm(15,"app-categoria-select",13),o.k0s(),o.j41(16,"app-campo-formulario",14),o.nrm(17,"app-pagamento-select",15),o.k0s(),o.j41(18,"div",16)(19,"app-botao",17),o.EFF(20),o.k0s(),o.DNE(21,j,2,3,"app-botao",18),o.k0s()()(),o.j41(22,"div")(23,"h3",19)(24,"span"),o.EFF(25),o.k0s(),o.j41(26,"div",20),o.nrm(27,"app-input-data",21),o.k0s()(),o.j41(28,"div",22),o.DNE(29,P,24,18,"div",23)(30,k,2,0,"div",24),o.k0s()()()),2&a){let l,i;o.R7$(7),o.Y8G("formGroup",e.transacaoForm),o.R7$(),o.Y8G("nomeControle","descricao")("obrigatorio",!0),o.R7$(2),o.Y8G("nomeControle","valor")("obrigatorio",!0),o.R7$(2),o.Y8G("nomeControle","data")("obrigatorio",!0),o.R7$(2),o.Y8G("nomeControle","categoria")("obrigatorio",!0)("mensagensErro",o.lJ4(28,R)),o.R7$(),o.Y8G("obrigatorio",!0)("tocado",null!==(l=null==(l=e.transacaoForm.get("categoria"))?null:l.touched)&&void 0!==l&&l),o.R7$(),o.Y8G("nomeControle","metodoPagamento")("obrigatorio",!0),o.R7$(),o.Y8G("cartoes",e.cartoes())("obrigatorio",!0)("tocado",null!==(i=null==(i=e.transacaoForm.get("metodoPagamento"))?null:i.touched)&&void 0!==i&&i),o.R7$(2),o.Y8G("tipo",e.TipoBotaoEnum.Primario)("tamanho",e.TamanhoBotaoEnum.Grande)("cheio",!0),o.R7$(),o.JRh(e.editandoId()?"Salvar Edi\xe7\xe3o":"Confirmar Gasto"),o.R7$(),o.Y8G("ngIf",e.editandoId()),o.R7$(4),o.SpI("Hist\xf3rico ",e.filtroTodoPeriodo()?"Completo":"do M\xeas",""),o.R7$(),o.Y8G("formGroup",e.filtroForm),o.R7$(),o.Y8G("modo","mes")("acoesRapidas",!0),o.R7$(2),o.Y8G("ngForOf",e.transacoesFiltradas()),o.R7$(),o.Y8G("ngIf",0===e.transacoesFiltradas().length)}},dependencies:[m.MD,m.Sq,m.bT,m.oe,m.vh,s.X1,s.qT,s.me,s.BC,s.cb,s.j4,s.JD,x.E,b.k,v.J,E.E,F.a,T.n],encapsulation:2})}}return n})()}}]);